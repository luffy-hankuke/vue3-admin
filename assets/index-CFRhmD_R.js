import{b as I}from"./columns-4eY50L7w.js";import{k as d,a as R,aA as C,d as T,f as b,W as D,X as g,am as k,u as l,Y as u,G as v,ac as P}from"./vue-Dbi1xauY.js";import{f as S}from"./dateUtil-NBcmMhwL.js";import{z as A,A as i}from"./index-DWJF4vuV.js";import{U as N,be as V}from"./antdv-CAXihDg_.js";import{u as $}from"./dynamic-table-DhiAq_hs.js";import"./ApiSelect.vue_vue_type_script_setup_true_lang-IWTYr-Fy.js";import"./index.vue_vue_type_style_index_0_lang-Dww9ZzaR.js";import{u as q}from"./useFormModal-DGpV1vZs.js";import"./schema-form.vue_vue_type_script_setup_true_lang-C0d9vjpU.js";import"./is-C0dFuREE.js";import"./index-CCwlABZW.js";import"./useModal-BsEyE0vB.js";function z(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!R(e)}const f="/system/dict-item/:id",F=e=>A.hasRoute(f)?d(C,{to:{name:f,params:{id:e.id}}},{default:()=>[e.code]}):e.code,L=[{title:"ID",dataIndex:"id",sorter:!0,width:60},{title:"字典名称",dataIndex:"name"},{title:"字典编码",dataIndex:"code",customRender:({record:e})=>d(F,e,null)},{title:"状态",dataIndex:"status",width:80,customRender:({record:e})=>{const n=~~e.status===1,c=n?"green":"red",a=n?"启用":"停用";return d(N,{color:c},z(a)?a:{default:()=>[a]})}},{title:"备注",dataIndex:"remark"},{title:"更新时间",dataIndex:"updatedAt",sorter:!0,width:160,customRender:({record:e})=>S(e.createdAt)}],M=[{field:"name",label:"字典名称",component:"Input",colProps:{span:8}},{field:"code",label:"字典编码",component:"Input",colProps:{span:8}}],j=[{field:"name",component:"Input",label:"字典名称",rules:[{required:!0,type:"string"}]},{field:"code",component:"Input",label:"字典编码",rules:[{required:!0,type:"string"}]},{field:"status",label:"状态",component:"RadioGroup",defaultValue:1,componentProps:{options:[{label:"启用",value:1},{label:"禁用",value:0}]}},{field:"remark",component:"InputTextArea",label:"备注",colProps:{span:24},componentProps:{autoSize:{minRows:2}}}],ee=T({name:"SystemDict",__name:"index",setup(e){const r=b({}),n=b({}),[c,a]=$({formProps:{schemas:M}}),[h]=q(),y=async t=>{const[s]=await h({modalProps:{title:`${t.id?"编辑":"新增"}字典`,width:"50%",onFinish:async o=>{t.id?await i.systemDictType.dictTypeUpdate({id:t.id},o):await i.systemDictType.dictTypeCreate(o),a==null||a.reload()}},formProps:{labelWidth:120,schemas:j}});s==null||s.setFieldsValue({...t})},w=async t=>{await i.systemDictType.dictTypeDelete({id:t.id}),a==null||a.reload()},x=[...L,{title:"操作",width:130,dataIndex:"ACTION",hideInSearch:!0,fixed:"right",actions:({record:t})=>[{label:"编辑",auth:{perm:"system:dict-type:update",effect:"disable"},onClick:()=>y(t)},{label:"删除",auth:"system:dict-type:delete",popConfirm:{title:"你确定要删除吗？",placement:"left",onConfirm:()=>w(t)}}]}],_=async(t,s)=>{const o=s.id;if(t){n.value[o]=!0;const{items:m=[]}=await i.systemDictItem.dictItemList({typeId:o}).finally(()=>n.value[o]=!1);r.value[o]=m}};return(t,s)=>{const o=P("a-button"),m=V;return D(),g(l(c),{"row-key":"id","header-title":"字典管理","data-request":l(i).systemDictType.dictTypeList,columns:x,bordered:"",size:"small",onExpand:_},k({toolbar:u(()=>[d(o,{type:"primary",disabled:!t.$auth("system:dict-type:create"),onClick:s[0]||(s[0]=p=>y({}))},{default:u(()=>[v(" 新增 ")]),_:1},8,["disabled"])]),_:2},[t.$router.hasRoute(l(f))?{name:"expandedRowRender",fn:u(({record:p})=>[d(m,{size:"small",columns:l(I),loading:n.value[p.id],"data-source":r.value[p.id],pagination:!1},null,8,["columns","loading","data-source"])]),key:"0"}:void 0]),1032,["data-request"])}}});export{ee as default};
