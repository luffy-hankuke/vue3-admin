import{B as K}from"./index-DWJF4vuV.js";import{d as Q,at as I,$ as ee,as as te,f as P,w as U,W as X,X as Y,k as L,Y as y,a6 as k,u as g,_ as oe,am as se,Z as $,ai as ne,E as le,G as v,ak as ie,B as ae,y as _}from"./vue-Dbi1xauY.js";import{av as re,M as ce,o as ue,a0 as me,N as de,O as fe,p as pe,aw as z}from"./antdv-CAXihDg_.js";const he=k("br",null,null,-1),ye=k("br",null,null,-1),ge=k("br",null,null,-1),Le=Q({__name:"index",props:I({...re(),fullscreen:{type:Boolean,default:!1}},{open:{type:Boolean},openModifiers:{}}),emits:I(["update:open","update:fullscreen","ok","cancel"],["update:open"]),setup(H,{emit:j}){const M=H,C=j,G=ee(),w=te(H,"open"),r=P(M.fullscreen),O=P(""),s={top:"n-resize",left:"w-resize",right:"e-resize",bottom:"s-resize",topLeft:"nw-resize",topright:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",auto:"auto"};let q=!1;const b=P(),N=()=>{w.value=!1,C("cancel")},D=async()=>{var t;await _();const o=(t=b.value)==null?void 0:t.querySelector(".ant-modal");o&&o.getBoundingClientRect().left<1&&(o.style.left=`${(document.documentElement.clientWidth-o.offsetWidth)/2}px`)},Z=async()=>{r.value=!1,D()},A=(o,t)=>{t.style.cursor="move",t.onmousedown=z(e=>{if(r.value)return;document.body.style.userSelect="none";const c=e.clientX-o.getBoundingClientRect().left,u=e.clientY-o.getBoundingClientRect().top,n=l=>{if(r.value)return;let i=l.clientX-c,m=l.clientY-u;const f=document.documentElement.clientWidth-o.offsetWidth,p=document.documentElement.clientHeight-o.offsetHeight;i<=0&&(i=0),m<=0&&(m=0),i>=f&&(i=f),m>=p&&(m=p),o.style.left=`${Math.max(i,0)}px`,o.style.top=`${Math.max(m,0)}px`},a=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",a),document.body.style.userSelect="auto"};document.addEventListener("mousemove",n),document.addEventListener("mouseup",a)},20)},J=async()=>{await _();const o=b.value,t=o.querySelector(".ant-modal-wrap"),e=o.querySelector(".ant-modal");if(t&&e){D();const c=e.querySelector(".ant-modal-header");c&&A(e,c),t.onmousemove=z(u=>{if(r.value)return;const n=u.clientX-e.offsetLeft,a=u.clientY-e.offsetTop,l=u.clientX-e.offsetWidth-e.offsetLeft,i=u.clientY-e.offsetHeight-e.offsetTop,m=n<=0&&n>-8,f=a<5&&a>-8,p=l>=0&&l<8,W=i>-5&&i<8;m&&a>5&&i<-5?t.style.cursor=s.left:f&&n>5&&l<-5?t.style.cursor=s.top:p&&a>5&&i<-5?t.style.cursor=s.right:W&&n>5&&l<-5?t.style.cursor=s.bottom:n>-8&&n<=5&&a<=5&&a>-8?t.style.cursor=s.topLeft:n>-8&&n<=5&&i<=5&&i>-8?t.style.cursor=s.bottomLeft:l<8&&l>=-5&&a<=5&&a>-8?t.style.cursor=s.topright:l<8&&l>=-5&&i<=5&&i>-8?t.style.cursor=s.bottomRight:t.style.cursor=s.auto},20),t.onmousedown=u=>{if(r.value)return;const{top:n,bottom:a,left:l,right:i}=e.getBoundingClientRect(),m=u.clientX-l,f=u.clientY-n,p=e.offsetWidth,W=e.offsetHeight,d=t.style.cursor,V=z(h=>{if(r.value)return;d!==s.auto&&(document.body.style.userSelect="none");const x=`${Math.max(0,h.clientX-m)}px`,B=`${Math.max(0,h.clientY-f)}px`,R=`${Math.min(i,p+l-h.clientX)}px`,S=`${Math.min(window.innerWidth-l,h.clientX-l)}px`,E=`${Math.min(a,W+n-h.clientY)}px`,T=`${Math.min(window.innerHeight-n,h.clientY-n)}px`;d===s.left?(e.style.left=x,e.style.width=R):d===s.top?(e.style.top=B,e.style.height=E):d===s.right?e.style.width=S:d===s.bottom?e.style.height=T:d===s.topLeft?(e.style.left=x,e.style.top=B,e.style.height=E,e.style.width=R):d===s.topright?(e.style.top=B,e.style.width=S,e.style.height=E):d===s.bottomLeft?(e.style.left=x,e.style.width=R,e.style.height=T):d===s.bottomRight&&(e.style.width=S,e.style.height=T),O.value=e.style.width},20),F=()=>{document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",F),document.body.style.userSelect="auto",t.style.cursor=s.auto};document.addEventListener("mousemove",V),document.addEventListener("mouseup",F)}}q=!0};return U(w,async o=>{(o&&Object.is(q,!1)||M.destroyOnClose)&&J()}),U(()=>G.fullPath,N),(o,t)=>{const e=K;return X(),Y(le,{to:o.getContainer||"body"},[L(e,null,{default:y(()=>[k("div",{ref_key:"modalWrapRef",ref:b,class:ne(["draggable-modal",{fullscreen:r.value}])},[L(g(ce),oe(g(ue)(M,["open","onCancel","onOk","onUpdate:open"]),{open:w.value,"onUpdate:open":t[2]||(t[2]=c=>w.value=c),"mask-closable":!1,"get-container":()=>b.value,width:O.value||o.width,onOk:t[3]||(t[3]=c=>C("ok")),onCancel:t[4]||(t[4]=c=>C("cancel"))}),se({title:y(()=>[$(o.$slots,"title",{},()=>[v(ie(o.$attrs.title||"标题"),1)])]),closeIcon:y(()=>[$(o.$slots,"closeIcon",{},()=>[L(g(me),{class:"ant-modal-operate",onClick:t[1]||(t[1]=ae(()=>{},["stop"]))},{default:y(()=>[r.value?(X(),Y(g(fe),{key:1,onClick:Z})):(X(),Y(g(de),{key:0,onClick:t[0]||(t[0]=c=>r.value=!0)})),L(g(pe),{onClick:N})]),_:1})])]),default:y(()=>[$(o.$slots,"default",{},()=>[v(" ① 窗口可以拖动；"),he,v(" ② 窗口可以通过八个方向改变大小；"),ye,v(" ③ 窗口可以最小化、最大化、还原、关闭；"),ge,v(" ④ 限制窗口最小宽度/高度。 ")])]),_:2},[o.$slots.footer?{name:"footer",fn:y(()=>[$(o.$slots,"footer")]),key:"0"}:void 0]),1040,["open","get-container","width"])],2)]),_:3})],8,["to"])}}});export{Le as _};
